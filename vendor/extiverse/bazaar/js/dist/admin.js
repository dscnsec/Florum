module.exports=function(t){var a={};function n(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=a,n.d=function(t,a,e){n.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,a){if(1&a&&(t=n(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var r in t)n.d(e,r,function(a){return t[a]}.bind(null,r));return e},n.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(a,"a",a),a},n.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},n.p="",n(n.s=23)}([function(t,a){t.exports=flarum.core.compat.app},function(t,a){t.exports=flarum.core.compat.Model},function(t,a){t.exports=flarum.core.compat["components/Button"]},function(t,a){t.exports=flarum.core.compat.Component},function(t,a){t.exports=flarum.core.compat["components/Badge"]},function(t,a){t.exports=flarum.core.compat["helpers/icon"]},function(t,a){t.exports=flarum.core.compat["components/Modal"]},function(t,a){t.exports=flarum.core.compat["utils/computed"]},function(t,a){t.exports=flarum.core.compat["components/LinkButton"]},function(t,a){t.exports=flarum.core.compat.extend},function(t,a){t.exports=flarum.core.compat["utils/mixin"]},function(t,a){t.exports=flarum.core.compat["components/SettingsModal"]},function(t,a){t.exports=flarum.core.compat["components/Switch"]},function(t,a){t.exports=flarum.core.compat["helpers/fullTime"]},function(t,a){t.exports=flarum.core.compat["utils/ItemList"]},function(t,a){t.exports=flarum.core.compat["utils/extract"]},function(t,a){t.exports=flarum.core.compat["components/AdminNav"]},function(t,a){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,a){t.exports=flarum.core.compat["components/Dropdown"]},function(t,a){t.exports=flarum.core.compat["components/Placeholder"]},function(t,a){t.exports=flarum.core.compat["utils/extractText"]},function(t,a){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,a){t.exports=flarum.core.compat["helpers/humanTime"]},function(t,a,n){"use strict";n.r(a);var e=n(9),r=n(0),i=n.n(r);function o(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}var s=n(1),l=n.n(s),c=n(10),u=n.n(c),p=n(7),d=n.n(p),f=function(t){function a(){return t.apply(this,arguments)||this}return o(a,t),a}(u()(l.a,{package:l.a.attribute("package"),title:l.a.attribute("title"),description:l.a.attribute("description"),license:l.a.attribute("license"),icon:l.a.attribute("icon"),locale:l.a.attribute("locale"),discuss_link:l.a.attribute("discuss_link"),landing_link:l.a.attribute("landing_link"),downloads:l.a.attribute("downloads"),installed:l.a.attribute("installed"),enabled:l.a.attribute("enabled"),pending:l.a.attribute("pending"),installed_version:l.a.attribute("installed_version"),highest_version:l.a.attribute("highest_version"),outdated:l.a.attribute("outdated"),flarum_id:l.a.attribute("flarum_id"),premium:l.a.attribute("premium"),subscribed:l.a.attribute("subscribed"),can_install:d()("installed","premium","subscribed","flarumCompatibilityCurrent",function(t,a,n,e){return!t&&e&&(!a||n)}),can_uninstall:d()("installed","enabled",function(t,a){return t&&!a}),can_enable:d()("installed","enabled",function(t,a){return t&&!a}),can_disable:d()("installed","enabled",function(t,a){return t&&a}),canCheckout:l.a.attribute("canCheckout"),canUnsubscribe:l.a.attribute("canUnsubscribe"),canSafelyUnsubscribe:d()("canUnsubscribe","installed",function(t,a){return t&&!a}),favorites:l.a.attribute("favorites"),favorited:l.a.attribute("favorited"),flarumCompatibilityLatest:l.a.attribute("flarumCompatibilityLatest"),flarumCompatibilityNext:l.a.attribute("flarumCompatibilityNext"),flarumCompatibilityCurrent:l.a.attribute("flarumCompatibilityCurrent")})),h=function(t){function a(){return t.apply(this,arguments)||this}return o(a,t),a}(u()(l.a,{status:l.a.attribute("status"),command:l.a.attribute("command"),package:l.a.attribute("package"),output:l.a.attribute("output"),created_at:l.a.attribute("created_at"),started_at:l.a.attribute("started_at"),finished_at:l.a.attribute("finished_at")})),b=n(16),g=n.n(b),v=n(17),x=n.n(v),y=n(3),z=n.n(y),k=function(){function t(t){this.extensions=m.prop([]),this.loading=t}var a=t.prototype;return a.requestError=function(){this.loading("error"),m.redraw()},a.installExtension=function(t){var a=this;this.loading(!0),i.a.request({method:"POST",url:i.a.forum.attribute("apiUrl")+"/bazaar-extensions",timeout:0,data:{id:t.id()}}).then(function(t){return a.updateExtensionInRepository(t)}).catch(function(){return a.requestError()})},a.installFailure=function(t){this.resetNavigation(),this.loadNextPage()},a.uninstallExtension=function(t){var a=this;this.loading(!0),i.a.request({method:"DELETE",timeout:0,url:i.a.forum.attribute("apiUrl")+"/bazaar-extensions/"+t.id()}).then(function(t){return a.updateExtensionInRepository(t)}).catch(function(){return a.requestError()})},a.uninstallFailure=function(t){this.resetNavigation(),this.loadNextPage()},a.favoriteExtension=function(t){var a=this;this.loading(!0),i.a.request({method:"post",url:i.a.forum.attribute("apiUrl")+"/bazaar-extensions/"+t.id()+"/favorite",data:{favorite:1!=t.favorited()}}).then(function(t){return a.updateExtensionInRepository(t)}).catch(function(){return a.requestError()})},a.premiumExtensionSubscribe=function(t,a){void 0===a&&(a=!0),function(t){void 0===t&&(t={});var a=t.url||"/",n=t.waitForUrl||null,e=t.width||600,r=t.height||400,i=$(window),o=m.deferred(),s=window.open(a,"bazaarPopup","width="+e+",height="+r+",top="+(i.height()/2-r/2)+",left="+(i.width()/2-e/2)+",status=no,scrollbars=no,resizable=no"),l=window.setInterval(function(){try{s.closed?(window.clearInterval(l),o.reject()):s.document.URL===n&&(window.clearInterval(l),s.close(),o.resolve())}catch(t){}},500);return o.promise}({url:i.a.forum.attribute("apiUrl")+"/bazaar/redirect/"+(a?"":"un")+"subscribe/"+t.id(),waitForUrl:i.a.forum.attribute("apiUrl")+"/bazaar/callback/subscription"}).then(function(){window.location.reload()}).catch(function(){alert(i.a.translator.trans("bazaar.admin.page.extension.subscribe_check_failed"))})},a.premiumExtensionUnsubscribe=function(t){this.premiumExtensionSubscribe(t,!1)},a.updateExtension=function(t){var a=this;this.loading(!0),i.a.request({url:i.a.forum.attribute("apiUrl")+"/bazaar-extensions/"+t.id(),timeout:0,method:"PATCH"}).then(function(t){return a.updateExtensionInRepository(t)}).catch(function(){return a.requestError()})},a.toggleExtension=function(t){var a=this;this.loading(!0);var n=t.enabled();i.a.request({url:i.a.forum.attribute("apiUrl")+"/bazaar-extensions/"+t.id()+"/toggle",method:"PATCH",data:{enabled:!n}}).then(function(t){return a.updateExtensionInRepository(t)}).catch(function(){return a.requestError()})},a.disableExtension=function(t){return this.toggleExtension(t)},a.enableExtension=function(t){return this.toggleExtension(t)},a.getExtensionIndex=function(t){return this.extensions().findIndex(function(a){return a.id()==t.id()})},a.updateExtensionInRepository=function(t){this.loading(!1);var a=i.a.store.pushObject(t.data);return this.extensions()[this.getExtensionIndex(a)]=a,m.redraw(),a},t}(),w=n(2),N=n.n(w),_=n(5),B=n.n(_),E=n(14),q=n.n(E),I=n(18),P=n.n(I),C=n(4),M=n.n(C),T=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.config=function(t){t||this.props.extension.description()&&this.$(".ExtensionIcon").tooltip({container:"body"})},n.view=function(){var t=this.props.extension,a=this.props.connected||!1,n=this.controlItems(t,a).toArray(),e=this.badges(t).toArray(),r=this.props.repository;return m("div",{className:"Extension "+(t.enabled()?"enabled ":"disabled ")+(t.installed()?"installed ":"uninstalled ")+(t.outdated()?"outdated ":"")+(t.pending()?"pending ":"")+(n.length>0?"hasControls":"")+(t.favorited()?"favorited":"")+(t.flarumCompatibilityCurrent()?" compatible":"incompatible"),key:t.id(),"data-id":t.id()},m("span",{className:"Extension-icon",style:t.icon()||"",title:t.description()},t.icon()?B()("fas fa-"+t.icon().name):""),m("div",{className:"Extension-meta"},m("ul",{className:"ExtensionListItem-badges badges"},e),m("label",{className:"Meta-Title"},t.title()||t.package()),m("div",{className:"Meta-Item description"},t.description()),m("div",{className:"Meta-Item vendor"},m("div",{className:"label"},m("i",{className:"fas fa-user"})," ",app.translator.trans("bazaar.admin.page.extension.vendor")),m("div",{className:"value"},t.package().split("/")[0])),m("div",{className:"Meta-Item downloads"},m("div",{className:"label"},m("i",{class:"fas fa-download"})," ",app.translator.trans("bazaar.admin.page.extension.downloads")),m("div",{className:"value"},t.downloads())),m("div",{className:"Meta-Item favorites"},m("div",{className:"label"},m("i",{className:"fas fa-heart"})," ",app.translator.trans("bazaar.admin.page.extension.favorites")),m("div",{className:"value"},t.favorites())),t.installed_version()?m("div",{className:"Meta-Item version"},m("div",{className:"label"},app.translator.trans("bazaar.admin.page.extension.installed_version")),m("div",{className:"value"},t.installed_version())):"",m("div",{className:"Meta-Item version"},m("div",{className:"label"},app.translator.trans("bazaar.admin.page.extension.highest_version")),m("div",{className:"value"},t.highest_version())),m("div",{className:"Extension-controls"},a?m(N.a,{className:"Button Button--icon Button--flat favorite",icon:(t.favorited()?"fas":"far")+" fa-heart",onclick:function(){return r.favoriteExtension(t)}}):"",t.discuss_link()?m(N.a,{className:"Button Button--icon Button--flat",icon:"fas fa-comments",onclick:function(){return window.open(t.discuss_link())}}):"",t.landing_link()?m(N.a,{className:"Button Button--icon Button--flat",icon:"fas fa-chart-line",onclick:function(){return window.open(t.landing_link())}}):"",n.length>0?m(P.a,{buttonClassName:"Button Button--icon Button--flat",menuClassName:"Dropdown-menu--right",icon:"fas fa-ellipsis-h"},n):"")))},n.controlItems=function(t,a){var n=this,e=new q.a,r=this.props.repository,i=t.favorited()?"bazaar.admin.page.button.remove_favorite_button":"bazaar.admin.page.button.favorite_button";return a&&e.add("favorite",N.a.component({icon:"fas fa-heart",children:app.translator.trans(i),onclick:function(){r.favoriteExtension(t)}})),t.pending()||(t.enabled()&&app.extensionSettings[name]&&e.add("settings",N.a.component({icon:"fas fa-cog",children:app.translator.trans("core.admin.extensions.settings_button"),onclick:app.extensionSettings[name]})),t.can_uninstall()&&e.add("uninstall",N.a.component({icon:"fas fa-minus-square",children:app.translator.trans("bazaar.admin.page.button.uninstall"),onclick:function(){n.props.extension=r.uninstallExtension(t)}})),t.can_enable()&&e.add("enable",N.a.component({icon:"fas fa-check-square",children:app.translator.trans("bazaar.admin.page.button.enable"),onclick:function(){r.enableExtension(t)}})),t.installed()&&t.outdated()&&e.add("update",N.a.component({icon:"fas fa-level-up",children:app.translator.trans("bazaar.admin.page.button.update"),onclick:function(){n.props.extension=r.updateExtension(t)}})),t.can_disable()&&e.add("disable",N.a.component({icon:"fas fa-square",children:app.translator.trans("bazaar.admin.page.button.disable"),onclick:function(){n.props.extension=r.disableExtension(t)}})),t.can_install()&&e.add("install",N.a.component({icon:"fas fa-plus-square",children:app.translator.trans("bazaar.admin.page.button.install"),onclick:function(){n.props.extension=r.installExtension(t)}}))),t.premium()&&!a&&e.add("subscribe",N.a.component({disabled:!0,icon:"fas fa-shopping-cart",children:app.translator.trans("bazaar.admin.page.button.connect_to_subscribe")})),t.canCheckout()&&a&&e.add("subscribe",N.a.component({icon:"fas fa-shopping-cart",children:app.translator.trans("bazaar.admin.page.button.subscribe"),onclick:function(){r.premiumExtensionSubscribe(t)}})),t.canSafelyUnsubscribe()&&a&&e.add("unsubscribe",N.a.component({icon:"fas fa-ban",children:app.translator.trans("bazaar.admin.page.button.unsubscribe"),onclick:function(){r.premiumExtensionUnsubscribe(t)}})),e},n.badges=function(t){var a=new q.a;return t.flarumCompatibilityNext()||a.add("nextIncompatible",m(M.a,{icon:"fas fa-exclamation",type:"nextIncompatible",label:app.translator.trans("bazaar.admin.page.extension.next_incompatible")})),t.flarumCompatibilityLatest()||a.add("latestIncompatible",m(M.a,{icon:"fas fa-exclamation-circle",type:"latestIncompatible",label:app.translator.trans("bazaar.admin.page.extension.latest_incompatible")})),t.flarumCompatibilityCurrent()||a.add("incompatible",m(M.a,{icon:"fas fa-exclamation-triangle",type:"incompatible",label:app.translator.trans("bazaar.admin.page.extension.incompatible")})),t.subscribed()?a.add("subscribed",m(M.a,{icon:"fas fa-shopping-cart",type:"subscribed",label:app.translator.trans("bazaar.admin.page.extension.subscribed")})):t.premium()&&a.add("premium",m(M.a,{icon:"fas fa-certificate",type:"premium",label:app.translator.trans("bazaar.admin.page.extension.premium")})),t.pending()&&a.add("pending",m(M.a,{icon:"fas fa-circle-notch fa-spin",type:"pending",label:app.translator.trans("bazaar.admin.page.extension.pending")})),t.installed()&&t.outdated()&&a.add("outdated",m(M.a,{icon:"fas fa-sort-numeric-down",type:"outdated",label:app.translator.trans("bazaar.admin.page.extension.outdated",{new:t.highest_version()})})),t.favorited()&&a.add("favorited",m(M.a,{icon:"fas fa-heart",type:"favorited",label:app.translator.trans("bazaar.admin.page.extension.favorited")})),t.installed()&&!t.enabled()&&a.add("installed",m(M.a,{icon:"fas fa-plus-square",type:"installed",label:app.translator.trans("bazaar.admin.page.extension.installed")})),t.enabled()&&a.add("enabled",m(M.a,{icon:"fas fa-check-square",type:"enabled",label:app.translator.trans("bazaar.admin.page.extension.enabled")})),a},a}(z.a),U=n(8),L=n.n(U),R=function(t){function a(){return t.apply(this,arguments)||this}return o(a,t),a.prototype.view=function(){var t=this,a="error"===this.props.loading();return m("div",{className:"Bazaar--Loader "+(a?"Error":null),hidden:!1===this.props.loading()},[m(".Loader-modal",[m(".Loader-icon",B()(a?"fas fa-exclamation-triangle":"fas fa-shopping-bag")),m("div",[m("p",app.translator.trans(a?"bazaar.admin.loader.error":"bazaar.admin.loader.is_loading")),a?[N.a.component({className:"Button Button--block",icon:"fas fa-sync",onclick:function(){return location.reload()},children:app.translator.trans("bazaar.admin.loader.refresh")}),N.a.component({className:"Button Button--block",icon:"fas fa-times",onclick:function(){return t.props.loading(!1)},children:app.translator.trans("bazaar.admin.loader.close")}),L.a.component({className:"Button Button--block",icon:"fas fa-bug",href:"https://github.com/flagrow/bazaar/issues",target:"_blank",config:{},children:app.translator.trans("bazaar.admin.loader.report_issue")})]:null])])])},a}(z.a),F=n(19),S=n.n(F),O=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.init=function(){this.loading=this.props.loading,this.moreResults=!1,this.resultMeta={},this.extensions=[],this.refresh()},n.view=function(){var t,a=this;if(this.loading()?t=R.component({loading:this.loading}):this.moreResults&&(t=[N.a.component({children:app.translator.trans("bazaar.admin.page.button.more",{current:this.resultMeta.pages_current+1,total:this.resultMeta.pages_total}),className:"Button Button--primary",onclick:this.loadMore.bind(this)})]),0===this.extensions.length&&!this.loading){var n=app.translator.trans("bazaar.admin.page.state.no_results_available");return this.props.authorized||(n=app.translator.trans("bazaar.admin.page.state.not_authorized")),m("div",{className:"DiscussionList"},S.a.component({text:n}))}return m("div",{className:"ExtensionList-wrapper"},m("div",{className:"ExtensionList"},this.extensions.map(function(t){return T.component({extension:t,repository:a.props.repository,connected:a.props.connected,key:t.package()})})),m("div",{className:"ExtensionList-loadMore"},t))},n.update=function(t){this.props.params=t,this.refresh()},n.refresh=function(t){var a=this;return void 0===t&&(t=!0),t&&(this.loading(!0),this.extensions=[]),this.loadResults().then(function(t){a.extensions=[],a.parseResults(t)},function(){a.loading(!1),m.redraw()})},n.loadResults=function(t){var a=this.requestParams();return a.page={offset:t},a.include=a.include.join(","),app.store.find("bazaar-extensions",a)},n.parseResults=function(t){return[].push.apply(this.extensions,t),this.loading(!1),this.moreResults=!!t.payload.links.next,this.resultMeta=t.payload.meta||{},m.lazyRedraw(),t},n.loadMore=function(){this.loading(!0),this.loadResults(this.extensions.length).then(this.parseResults.bind(this))},n.requestParams=function(){var t=this.props.params,a={include:[],filter:{}};return a.sort=this.sortMap()[t.sort],t.q&&(a.filter.q=t.q),t.filter&&(a.filter=window.$.param(t.filter)),a},n.sortMap=function(){var t={};return this.props.params.q&&(t.relevance=""),t},a}(z.a);function j(){return(j=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t}).apply(this,arguments)}var H=n(15),D=n.n(H),A=n(20),G=n.n(A),J=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.view=function(){var t=Object.assign({},this.props);delete t.state,delete t.children,t.className=t.className||"",t.type=t.type||"button",this.props.state&&(t.className+=" active"),!t.title&&this.props.children&&(t.title=G()(this.props.children)),D()(t,"icon")&&(t.className+=" hasIcon");var a=D()(t,"loading");return(t.disabled||a)&&(t.className+=" disabled"+(a?" loading":""),delete t.onclick),m("button",j({},t,{onclick:this.onchange.bind(this)}),this.getButtonContent())},n.onchange=function(){this.props.onchange&&this.props.onchange(!this.props.state,this)},a}(N.a),K=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.init=function(){var t=this;this.updateDebounce=function(t,a,n){var e;return function(){var r=this,i=arguments,o=n&&!e;clearTimeout(e),e=setTimeout(function(){e=null,n||t.apply(r,i)},a),o&&t.apply(r,i)}}(function(){t.props.onsubmit&&t.props.onsubmit(t.props.params)},500)},n.view=function(){var t=this;return m("div",[m("fieldset",{className:"ExtensionSearch"},m("input[type=text].FormControl",{value:this.props.params.q||"",oninput:m.withAttr("value",function(a){return t.search(a)}),placeholder:app.translator.trans("bazaar.admin.search.placeholder")})),m("div",{className:"ExtensionFilters ButtonGroup"},[J.component({icon:"fas fa-level-up",className:"Button hasIcon",state:this.isToggled("update"),onchange:function(a){return t.toggleFilter("update",a)},children:app.translator.trans("bazaar.admin.search.filter_update")}),J.component({icon:"fas fa-circle-notch",className:"Button hasIcon",state:this.isToggled("pending"),onchange:function(a){return t.toggleFilter("pending",a)},children:app.translator.trans("bazaar.admin.search.filter_pending")}),J.component({icon:"fas fa-plus-square",className:"Button hasIcon",state:this.isToggled("installed"),onchange:function(a){return t.toggleFilter("installed",a)},children:app.translator.trans("bazaar.admin.search.filter_installed")}),this.connected?[J.component({icon:"fas fa-heart",className:"Button hasIcon",state:this.isToggled("favorited"),onchange:function(a){return t.toggleFilter("favorited",a)},children:app.translator.trans("bazaar.admin.search.filter_favorited")}),J.component({icon:"fas fa-shopping-cart",className:"Button hasIcon",state:this.isToggled("subscribed"),onchange:function(a){return t.toggleFilter("subscribed",a)},children:app.translator.trans("bazaar.admin.search.filter_subscribed")})]:"",J.component({icon:"fas fa-certificate",className:"Button hasIcon",state:this.isToggled("premium"),onchange:function(a){return t.toggleFilter("premium",a)},children:app.translator.trans("bazaar.admin.search.filter_premium")})])])},n.isToggled=function(t){return((this.props.params.filter||{}).is||[]).indexOf(t)>=0},n.toggleFilter=function(t,a){var n=this.props.params.filter||{},e=n.is||[],r=e.indexOf(t);a&&-1===r?e.push(t):!a&&r>=0&&e.splice(r,1),n.is=e,this.props.params.filter=n,this.updateDebounce()},n.search=function(t){this.props.params.q=t,this.updateDebounce()},a}(z.a),Q=n(6),V=n.n(Q),W=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.className=function(){return"FilePermissionsModal"},n.title=function(){return app.translator.trans("bazaar.admin.modal.requirements.file-permissions.title")},n.content=function(){var t=[];return this.props.file_permissions.forEach(function(a){t.push(m("li",m("span",{className:"code"},a)))}),m("div",{className:"Modal-body"},[m("p",app.translator.trans("bazaar.admin.modal.requirements.file-permissions.description",{a:m("a",{href:"https://github.com/flagrow/bazaar/wiki/File-permissions",target:"_blank"})})),m("ul",t)])},a}(V.a),X=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.className=function(){return"MemoryLimitModal"},n.title=function(){return app.translator.trans("bazaar.admin.modal.requirements.php-memory_limit.title")},n.content=function(){var t=this.props.memory_requested,a=this.props.memory_limit;return m("div",{className:"Modal-body"},app.translator.trans("bazaar.admin.modal.requirements.php-memory_limit.description",{required:t,limit:a,a:m("a",{href:"https://github.com/flagrow/bazaar/wiki/PHP-memory-limit",target:"_blank"})}))},a}(V.a),Y=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.className=function(){return"FilePermissionsModal"},n.title=function(){return app.translator.trans("bazaar.admin.modal.connect-bazaar.title")},n.content=function(){var t=this.props.flagrowHost;return m("div",{className:"Modal-body"},[m("p",app.translator.trans("bazaar.admin.modal.connect-bazaar.description",{host:t})),m("div",{className:"App-primaryControl"},[N.a.component({type:"submit",className:"Button Button--primary Button--block",disabled:!1,icon:"check",children:app.translator.trans("bazaar.admin.page.button.connect")})])])},n.connect=function(){var t=window.open();app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/bazaar/connect"}).then(function(a){a&&a.redirect?t.location=a.redirect:t.close()})},n.onsubmit=function(){this.connect()},a}(V.a),Z=n(11),tt=n.n(Z),at=n(12),nt=n.n(at),et=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.title=function(){return i.a.translator.trans("bazaar.admin.modal.settings.title")},n.form=function(){return[m("div",{className:"Form-group"},[m("label",{for:"use-cron"},i.a.translator.trans("bazaar.admin.modal.settings.field.use_cron_for_tasks.label")),nt.a.component({state:this.setting("flagrow.bazaar.use_cron_for_tasks")(),onchange:this.setting("flagrow.bazaar.use_cron_for_tasks"),children:i.a.translator.trans("bazaar.admin.modal.settings.field.use_cron_for_tasks.toggle")}),m("span",i.a.translator.trans("bazaar.admin.modal.settings.field.use_cron_for_tasks.description",{a:m("a",{href:"https://github.com/flagrow/bazaar/wiki/Cron-task-processing",target:"_blank"})}))]),m("div",{className:"Form-group"},[m("label",{for:"bazaar-api-token"},i.a.translator.trans("bazaar.admin.modal.settings.field.token.label")),m("input",{id:"bazaar-api-token",className:"FormControl",bidi:this.setting("flagrow.bazaar.api_token")}),m("span",i.a.translator.trans("bazaar.admin.modal.settings.field.token.description"))])]},a}(tt.a),rt=n(21),it=n.n(rt),ot=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.title=function(){return app.translator.trans("bazaar.admin.modal.dashboard.title")},n.form=function(){var t=this.props.flagrowHost,a=this.setting("flagrow.bazaar.sync",!1);return m("div",{className:"Modal-body"},[m("p",app.translator.trans("bazaar.admin.modal.dashboard.sync.description",{host:t})),nt.a.component({state:!0===a()||1==a(),onchange:this.updateSetting.bind(this,a,"flagrow.bazaar.sync"),children:app.translator.trans("bazaar.admin.modal.dashboard.sync.switch",{host:t})})])},n.submitButton=function(){var t=this.props.flagrowHost;return m("div",{className:"ButtonGroup"},[N.a.component({className:"Button Connected",icon:"dashboard",children:app.translator.trans("bazaar.admin.modal.dashboard.visit-remote-dashboard"),onclick:function(){return window.open(t+"/home")}})])},n.updateSetting=function(t,a,n){var e;it()(((e={})[a]=n,e)),t(n)},a}(tt.a),st=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.view=function(){return m("div",{className:"ExtensionsPage-header"},m("div",{className:"container"},this.header()))},n.header=function(){var t=[].concat(this.pagesButtons(),this.settingsButton(),this.requirementsButtons(),this.connectedButtons());return m("div",{className:"ButtonGroup"},t)},n.settingsButton=function(){return[N.a.component({className:"Button Button--icon",icon:"fas fa-cog",onclick:function(){return i.a.modal.show(new et)}})]},n.requirementsButtons=function(){var t=i.a.data.settings["flagrow.bazaar.php.memory_limit-met"]||!1,a=i.a.data.settings["flagrow.bazaar.php.memory_limit"],n=i.a.data.settings["flagrow.bazaar.php.memory_requested"],e=i.a.data.settings["flagrow.bazaar.file-permissions"]||[],r=[];return t||r.push(N.a.component({className:"Button Button--icon Requirement-MemoryLimit",icon:"fas fa-signal",onclick:function(){return i.a.modal.show(new X({memory_requested:n,memory_limit:a}))}})),e.length>0&&r.push(N.a.component({className:"Button Button--icon Requirement-FilePermissions",icon:"fas fa-hdd",onclick:function(){return i.a.modal.show(new W({file_permissions:e}))}})),r},n.connectedButtons=function(){var t=this.props.connected,a=i.a.data.settings["flagrow.bazaar.flagrow-host"]||"https://flagrow.io";return t?[N.a.component({className:"Button Button--icon Connected",icon:"fas fa-plug",onclick:function(){return i.a.modal.show(new ot({flagrowHost:a}))}})]:[N.a.component({className:"Button Button--icon Connect",icon:"fas fa-plug",onclick:function(){return i.a.modal.show(new Y({flagrowHost:a}))}})]},n.pagesButtons=function(){if(void 0===i.a.current)return null;var t=i.a.current.props.routeName,a=[];return a.push(L.a.component({className:"Button Button--icon",icon:"fas fa-shopping-bag",href:i.a.route("flagrow-bazaar"),title:i.a.translator.trans("bazaar.admin.header.extensions"),active:"flagrow-bazaar"===t})),a.push(L.a.component({className:"Button Button--icon",icon:"fas fa-history",href:i.a.route("flagrow-bazaar-tasks"),title:i.a.translator.trans("bazaar.admin.header.tasks"),active:"flagrow-bazaar-tasks"===t})),a},a}(z.a),lt=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.init=function(){app.current=this,this.authorized=(app.data.settings["flagrow.bazaar.api_token"]||"").length>0,this.connected=app.data.settings["flagrow.bazaar.connected"]&&"0"!==app.data.settings["flagrow.bazaar.connected"],this.loading=m.prop(!0),this.params=this.params(),this.repository=new k(this.loading),this.extensionList=new O({params:this.params,loading:this.loading,repository:this.repository,connected:this.connected,authorized:this.authorized}),this.search=K.component({params:this.params,onsubmit:this.updateResults.bind(this)})},n.updateResults=function(t){this.params=t,this.extensionList.update(t)},n.view=function(){return m("div",{className:"Bazaar Extensions"},[st.component({connected:this.connected}),m("div",{className:"ExtensionsPage-list"},[m("div",{className:"container"},[this.search,this.extensionList.render()])])])},n.stickyParams=function(){return{sort:m.route.param("sort"),q:m.route.param("q")}},n.params=function(){var t=this.stickyParams();return t.filter=m.route.param("filter"),t},a}(z.a),ct=function(){function t(t){this.tasks=m.prop([]),this.nextPageUrl=null,this.loading=t,this.resetNavigation()}var a=t.prototype;return a.loadNextPage=function(){var t=this;!this.loading()&&this.nextPageUrl&&(this.loading(!0),i.a.request({method:"GET",url:this.nextPageUrl}).then(function(a){var n=a.data.map(function(t){return i.a.store.createRecord("bazaar-tasks",t)});t.tasks(n),t.nextPageUrl=null,t.loading(!1),m.redraw()}))},a.resetNavigation=function(){this.loading(!1),this.nextPageUrl=i.a.forum.attribute("apiUrl")+"/bazaar/tasks",this.tasks([])},t}(),ut=n(22),pt=n.n(ut),dt=n(13),mt=n.n(dt),ft=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.init=function(){this.extended=m.prop(!1)},n.view=function(){var t=this,a=this.props.task,n=function(){switch(a.status()){case"success":return"fas fa-check";case"exception":return"fas fa-exclamation";case"working":return"fas fa-spinner"}return"fas fa-clock"}();return m("tbody",{className:"TaskListItem status-"+a.status()},m("tr",null,m("td",{className:"time-column"},pt()(a.created_at())),m("td",{className:"status-column",title:i.a.translator.trans("bazaar.admin.page.task.status."+(null!==a.status()?a.status():"unknown"))},m("div",{className:"status"},B()(n))),m("td",{className:"command-column"},i.a.translator.trans("bazaar.admin.page.task.command."+a.command(),{extension:m("strong",null,a.package())})),m("td",{className:"details-column"},N.a.component({icon:"fas fa-plus",className:"Button",onclick:function(){t.extended(!t.extended())}}))),this.extended()?m("tr",null,m("td",{className:"output-column",colspan:"4"},m("dl",null,m("dt",null,i.a.translator.trans("bazaar.admin.page.task.attribute.created_at")),m("dd",null,mt()(a.created_at()))),m("dl",null,m("dt",null,i.a.translator.trans("bazaar.admin.page.task.attribute.started_at")),m("dd",null,mt()(a.started_at()))),m("dl",null,m("dt",null,i.a.translator.trans("bazaar.admin.page.task.attribute.finished_at")),m("dd",null,mt()(a.finished_at()))),m("p",null,i.a.translator.trans("bazaar.admin.page.task.header.output")),m("pre",{className:"output"},a.output()))):null)},a}(z.a),ht=function(t){function a(){return t.apply(this,arguments)||this}o(a,t);var n=a.prototype;return n.init=function(){i.a.current=this,this.loading=m.prop(!1),this.repository=new ct(this.loading),this.repository.loadNextPage(),this.loader=R.component({loading:this.loading}),this.connected=i.a.data.settings["flagrow.bazaar.connected"]&&"0"!==i.a.data.settings["flagrow.bazaar.connected"]},n.view=function(){return m("div",{className:"ExtensionsPage Bazaar TaskPage"},st.component({connected:this.connected}),m("div",{className:"ExtensionsPage-list"},m("div",{className:"container"},this.taskGroups().map(function(t){return t.tasks.length?m("div",null,m("h2",null,t.title),m("table",{className:"TaskPage-table"},m("thead",null,m("tr",null,m("th",{className:"time-column"},i.a.translator.trans("bazaar.admin.page.task.header.time")),m("th",{className:"status-column"},i.a.translator.trans("bazaar.admin.page.task.header.status")),m("th",null,i.a.translator.trans("bazaar.admin.page.task.header.command")),m("th",{className:"details-column"},i.a.translator.trans("bazaar.admin.page.task.header.details")))),t.tasks.map(function(t){return m(ft,{task:t})}))):null}))),this.loader)},n.taskGroups=function(){var t=[{title:i.a.translator.trans("bazaar.admin.page.task.group.today"),tasks:[]},{title:i.a.translator.trans("bazaar.admin.page.task.group.lastmonth"),tasks:[]},{title:i.a.translator.trans("bazaar.admin.page.task.group.older"),tasks:[]}],a=0,n=(new Date).setHours(0,0,0,0);return this.repository.tasks().forEach(function(e){var r=new Date(e.created_at()).setHours(0,0,0,0);switch(a){case 0:r===n?t[a].tasks.push(e):a++;break;case 1:(n-r)/864e5<=30?t[a].tasks.push(e):a++;break;default:t[a].tasks.push(e)}}),t},a}(z.a);i.a.initializers.add("extiverse-bazaar",function(t){t.store.models["bazaar-extensions"]=f,t.store.models["bazaar-tasks"]=h,i.a.routes["flagrow-bazaar"]={path:"/flagrow/bazaar",component:lt.component()},i.a.extensionSettings["flagrow-bazaar"]=function(){return m.route(i.a.route("flagrow-bazaar"))},Object(e.extend)(g.a.prototype,"items",function(t){t.add("flagrow-bazaar",x.a.component({href:i.a.route("flagrow-bazaar"),icon:"fas fa-shopping-bag",children:i.a.translator.trans("bazaar.admin.nav.title"),description:i.a.translator.trans("bazaar.admin.nav.description")}))}),i.a.routes["flagrow-bazaar-tasks"]={path:"/flagrow/bazaar/tasks",component:ht.component()}})}]);
//# sourceMappingURL=admin.js.map